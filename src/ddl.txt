create table policy_types
(
	id integer not null
		constraint policy_types_pk
			primary key autoincrement,
	policy_type varchar(30) not null
);

create unique index policy_types_id_uindex
	on policy_types (id);

create table risks
(
	id integer not null
		constraint risks_pk
			primary key autoincrement,
	price_from float not null,
	price_to float not null,
	description varchar(255) not null,
	policy_type_id integer not null
		constraint risks_policy_types_id_fk
			references policy_types
);

create unique index risks_id_uindex
	on risks (id);

create table addresses
(
	id integer not null
		constraint addresses_pk
			primary key autoincrement,
	country varchar(30) not null,
	zip_code varchar(20) not null,
	city varchar(30) not null,
	street varchar(40) not null,
	building_number varchar(20) not null,
	apartment_number varchar(20)
);

create unique index addresses_id_uindex
	on addresses (id);

create table people
(
	id integer not null
		constraint people_pk
			primary key autoincrement,
	pesel varchar(20),
	first_name varchar(30),
	last_name varchar(30)
);

create unique index people_id_uindex
	on people (id);

create table enterprises
(
	id integer not null
		constraint enterprises_pk
			primary key autoincrement
	nip varchar(30),
	regon varchar(30),
	representative_id integer
		constraint enterprises_people_id_fk
			references people
);

create table clients
(
	id integer not null
		constraint clients_pk
			primary key autoincrement,
	address_id integer
		constraint clients_addresses_id_fk
			references addresses,
	phone varchar(30),
	person_id integer
		constraint clients_people_id_fk
			references people,
	enterprise_id integer
		constraint clients_enterprises_id_fk
			references enterprises
);

create unique index clients_id_uindex
	on clients (id);


create table damage_types
(
	id integer,
	damage_type varchar(50)
);


create table documents
(
	id integer not null
		constraint documents_pk
			primary key autoincrement,
	document_url varchar(100)
);

create unique index documents_id_uindex
	on documents (id);


create table policies
(
	id integer not null
		constraint policies_pk
			primary key autoincrement,
	policyholder_id integer,
	insured_id integer,
	beneficiary_id integer,
	duration_from date,
	duration_to date,
	price float,
	policy_type integer,
	is_active boolean default true
);

create unique index policies_id_uindex
	on policies (id);


create table damages
(
	id integer not null
		constraint damages_pk
			primary key autoincrement,
	policy_id integer,
	damage_type integer
		constraint damages_damage_types_id_fk
			references damage_types (id),
	victim_id integer
		constraint damages_clients_id_fk
			references clients
);

create unique index damages_id_uindex
	on damages (id);


create table damages_documents
(
	id integer not null
		constraint damages_documents_pk
			primary key autoincrement,
	damage_id integer not null
		constraint damages_documents_damages_id_fk
			references damages,
	document_id integer not null
		constraint damages_documents_documents_id_fk
			references documents
);

create unique index damages_documents_id_uindex
	on damages_documents (id);


create table policies_risks
(
	id integer not null
		constraint policies_risks_pk
			primary key autoincrement,
	policy_id integer not null
		constraint policies_risks_policies_id_fk
			references policies,
	risk_id integer not null
		constraint policies_risks_risks_id_fk
			references risks
);

create unique index policies_risks_id_uindex
	on policies_risks (id);

